
Number of parameters: 4203522
/data/digbose92/ads_complete_repo/ads_codes/model_files/recent_models/log_dir/LSTM_multi_layer_tone_transition_model/20230220-225315_LSTM_multi_layer_tone_transition_model/20230220-225315_LSTM_multi_layer_tone_transition_model.yaml
Early stop criteria:5
Number of epochs:50
INFO Starting training
INFO {'data': {'csv_file': '/data/digbose92/ads_complete_repo/ads_codes/SAIM-ADS/data/SAIM_ads_data_message_tone_train_test_val_clip_features.csv'}, 'parameters': {'batch_size': 16, 'train_shuffle': True, 'val_shuffle': False, 'epochs': 50, 'early_stop': 5, 'max_length': 333, 'fps': 4, 'base_fps': 24, 'num_workers': 4}, 'device': {'is_cuda': True}, 'loss': {'loss_option': 'bce_cross_entropy_loss'}, 'optimizer': {'choice': 'Adam', 'lr': '1e-3', 'gamma': 0.5, 'step_size': 15, 'scheduler': 'step_lr', 'mode': 'max', 'decay': 0.001, 'patience': 5, 'factor': 0.5, 'verbose': True}, 'model': {'option': 'LSTM_multi_layer_tone_transition_model', 'model_type': 'LSTM', 'embedding_dim': 512, 'n_hidden': 512, 'n_layers': 2, 'n_classes': 2, 'batch_first': True}, 'output': {'model_dir': '/data/digbose92/ads_complete_repo/ads_codes/model_files/recent_models/model_dir', 'log_dir': '/data/digbose92/ads_complete_repo/ads_codes/model_files/recent_models/log_dir'}}


 40%|██████████████████████████████████████████████████████████████████████▉                                                                                                         | 149/370 [00:07<00:09, 22.33it/s]INFO Training loss:0.716



 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 299/370 [00:13<00:03, 21.90it/s]INFO Training loss:0.693
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 370/370 [00:17<00:00, 21.58it/s]
INFO epoch: 1, time:17.17
INFO Epoch:1,Overall Training loss:0.691,Overall training Acc:0.525, Overall F1:0.461
INFO Evaluating the dataset
 21%|████████████████████████████████████▉                                                                                                                                             | 11/53 [00:00<00:01, 28.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 53/53 [00:01<00:00, 34.90it/s]
Traceback (most recent call last):
  File "train_LSTM_model_tone_transition.py", line 277, in <module>
    main(config_data)
  File "train_LSTM_model_tone_transition.py", line 246, in main
    val_loss,val_acc,val_f1=gen_validate_score_LSTM_tone_transition_model(model,val_dl,device,criterion)
  File "/data/digbose92/ads_complete_repo/ads_codes/SAIM-ADS/scripts/evaluate_model.py", line 49, in gen_validate_score_LSTM_tone_transition_model
    val_acc=accuracy_score(target_labels,pred_labels_discrete)
  File "/data/digbose92/envs/miniconda3/envs/ads-env/lib/python3.8/site-packages/sklearn/utils/_param_validation.py", line 192, in wrapper
    return func(*args, **kwargs)
  File "/data/digbose92/envs/miniconda3/envs/ads-env/lib/python3.8/site-packages/sklearn/metrics/_classification.py", line 221, in accuracy_score
    y_type, y_true, y_pred = _check_targets(y_true, y_pred)
  File "/data/digbose92/envs/miniconda3/envs/ads-env/lib/python3.8/site-packages/sklearn/metrics/_classification.py", line 86, in _check_targets
    check_consistent_length(y_true, y_pred)
  File "/data/digbose92/envs/miniconda3/envs/ads-env/lib/python3.8/site-packages/sklearn/utils/validation.py", line 397, in check_consistent_length
    raise ValueError(
ValueError: Found input variables with inconsistent numbers of samples: [53, 837]